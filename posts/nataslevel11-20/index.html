<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" 
  
>
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Natas Wargame Writeup (Levels 11-20)" />
<meta name="author" content="ukom2" />
<meta property="og:locale" content="en" />
<meta name="description" content="Introduction" />
<meta property="og:description" content="Introduction" />
<link rel="canonical" href="http://localhost:4000/practice1.github.io/posts/nataslevel11-20/" />
<meta property="og:url" content="http://localhost:4000/practice1.github.io/posts/nataslevel11-20/" />
<meta property="og:site_name" content="ukom2 Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-08-07T16:56:00+04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Natas Wargame Writeup (Levels 11-20)" />
<meta name="twitter:site" content="@N/A" />
<meta name="twitter:creator" content="@ukom2" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ukom2","url":"https://github.com/ukom2/"},"dateModified":"2023-08-14T14:25:57+04:00","datePublished":"2023-08-07T16:56:00+04:00","description":"Introduction","headline":"Natas Wargame Writeup (Levels 11-20)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/practice1.github.io/posts/nataslevel11-20/"},"url":"http://localhost:4000/practice1.github.io/posts/nataslevel11-20/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Natas Wargame Writeup (Levels 11-20) | ukom2 Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/practice1.github.io/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/practice1.github.io/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/practice1.github.io/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/practice1.github.io/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/practice1.github.io/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="ukom2 Blog">
<meta name="application-name" content="ukom2 Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/practice1.github.io/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

  <link rel="stylesheet" href="/practice1.github.io/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();
      });
    } /* constructor() */

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isSysDarkPrefer() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get isLightMode() {
      return this.mode === ModeToggle.LIGHT_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    } /* flipMode() */
  } /* ModeToggle */

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper">
    <a href="/practice1.github.io/" id="avatar" class="rounded-circle">
      
        
        <img src="https://static.vecteezy.com/system/resources/thumbnails/009/292/244/small/default-avatar-icon-of-social-media-user-vector.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <div class="site-title">
      <a href="/practice1.github.io/">ukom2 Blog</a>
    </div>
    <div class="site-subtitle fst-italic">Blogs and Writeups produced by ukom2.</div>
  </div>
  <!-- .profile-wrapper -->

  <ul class="nav flex-column flex-grow-1 w-100 ps-0">
    <!-- home -->
    <li class="nav-item">
      <a href="/practice1.github.io/" class="nav-link">
        <i class="fa-fw fas fa-home"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
      <li class="nav-item">
        <a href="/practice1.github.io/tabs/categories.html" class="nav-link">
          <i class="fa-fw fas fa-stream"></i>
          

          <span>CATEGORIES</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/practice1.github.io/tabs/tags.html" class="nav-link">
          <i class="fa-fw fas fa-tags"></i>
          

          <span>TAGS</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/practice1.github.io/tabs/about.html" class="nav-link">
          <i class="fa-fw fas fa-info-circle"></i>
          

          <span>ABOUT</span>
        </a>
      </li>
      <!-- .nav-item -->
    
  </ul>
  <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/ukom2"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/N/A"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['example','domain.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/practice1.github.io/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</div>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container px-xxl-5">
        <!-- The Top Bar -->

<div id="topbar-wrapper">
  <div
    id="topbar"
    class="container d-flex align-items-center justify-content-between h-100"
  >
    <span id="breadcrumb">
      

      
        
          
            <span>
              <a href="/practice1.github.io/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>Natas Wargame Writeup (Levels 11-20)</span>
            

          
        
      
    </span>
    <!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </span>
    <span id="search-cancel">Cancel</span>
  </div>
</div>

        











<div class="row">
  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4">
    

    <div class="post px-1 px-md-2">
      

      
        
      
        <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->




<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  




<!-- return -->




<h1 data-toc-skip>Natas Wargame Writeup (Levels 11-20)</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class=""
  data-ts="1691412960"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug  7, 2023
</em>

    </span>

    <!-- lastmod date -->
    
    <span>
      Updated
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class=""
  data-ts="1692008757"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 14, 2023
</em>

    </span>
    

  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        
          <a href="https://github.com/ukom2/">ukom2</a>
          
        
      
      </em>
    </span>

    <div>
      <!-- read time -->
      <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="4141 words"
>
  <em>23 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <h2 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>This blog post contains the writeup for the <a href="http://overthewire.org/wargames/natas/"><strong>natas wargame</strong></a> levels 11 to 20.
If you haven’t already, I recommend reading the previous articles on the <a href="/posts/getting-started/"><strong>introduction</strong></a> and the writeup on <a href="/posts/nataslevel0to10/"><strong>Levels 0-10</strong></a>.</p>

<h2 id="level-11"><span class="me-2">Level 11</span><a href="#level-11" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h5 id="url-httpnatas11nataslabsoverthewireorg"><span class="me-2">URL: <a href="http://natas11.natas.labs.overthewire.org">http://natas11.natas.labs.overthewire.org</a></span><a href="#url-httpnatas11nataslabsoverthewireorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Credentials: <code class="language-plaintext highlighter-rouge">natas11:1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg</code></p>

<hr />

<h3 id="code"><span class="me-2">Code</span><a href="#code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?</span>

<span class="nv">$defaultdata</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="s2">"showpassword"</span><span class="o">=&gt;</span><span class="s2">"no"</span><span class="p">,</span> <span class="s2">"bgcolor"</span><span class="o">=&gt;</span><span class="s2">"#ffffff"</span><span class="p">);</span>

<span class="k">function</span> <span class="n">xor_encrypt</span><span class="p">(</span><span class="nv">$in</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$key</span> <span class="o">=</span> <span class="s1">'&lt;censored&gt;'</span><span class="p">;</span>
    <span class="nv">$text</span> <span class="o">=</span> <span class="nv">$in</span><span class="p">;</span>
    <span class="nv">$outText</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>

    <span class="c1">// Iterate through each character</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$text</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$outText</span> <span class="mf">.</span><span class="o">=</span> <span class="nv">$text</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$key</span><span class="p">[</span><span class="nv">$i</span> <span class="o">%</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$key</span><span class="p">)];</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$outText</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">loadData</span><span class="p">(</span><span class="nv">$def</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">global</span> <span class="nv">$_COOKIE</span><span class="p">;</span>
    <span class="nv">$mydata</span> <span class="o">=</span> <span class="nv">$def</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"data"</span><span class="p">,</span> <span class="nv">$_COOKIE</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$tempdata</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nf">xor_encrypt</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">"data"</span><span class="p">])),</span> <span class="kc">true</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$tempdata</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"showpassword"</span><span class="p">,</span> <span class="nv">$tempdata</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"bgcolor"</span><span class="p">,</span> <span class="nv">$tempdata</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/^#(?:[a-f\d]{6})$/i'</span><span class="p">,</span> <span class="nv">$tempdata</span><span class="p">[</span><span class="s1">'bgcolor'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$mydata</span><span class="p">[</span><span class="s1">'showpassword'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$tempdata</span><span class="p">[</span><span class="s1">'showpassword'</span><span class="p">];</span>
        <span class="nv">$mydata</span><span class="p">[</span><span class="s1">'bgcolor'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$tempdata</span><span class="p">[</span><span class="s1">'bgcolor'</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$mydata</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">saveData</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">setcookie</span><span class="p">(</span><span class="s2">"data"</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nf">xor_encrypt</span><span class="p">(</span><span class="nb">json_encode</span><span class="p">(</span><span class="nv">$d</span><span class="p">))));</span>
<span class="p">}</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nf">loadData</span><span class="p">(</span><span class="nv">$defaultdata</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"bgcolor"</span><span class="p">,</span><span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/^#(?:[a-f\d]{6})$/i'</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'bgcolor'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$data</span><span class="p">[</span><span class="s1">'bgcolor'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'bgcolor'</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">saveData</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>



<span class="cp">?&gt;</span>

<span class="nt">&lt;h1&gt;</span>natas11<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
<span class="nt">&lt;body</span> <span class="na">style=</span><span class="s">"background: </span><span class="cp">&lt;?=</span><span class="nv">$data</span><span class="p">[</span><span class="s1">'bgcolor'</span><span class="p">]</span><span class="cp">?&gt;</span><span class="s">;"</span><span class="nt">&gt;</span>
Cookies are protected with XOR encryption<span class="nt">&lt;br/&gt;&lt;br/&gt;</span>

<span class="cp">&lt;?</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$data</span><span class="p">[</span><span class="s2">"showpassword"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"yes"</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"The password for natas12 is &lt;censored&gt;&lt;br&gt;"</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>

<span class="nt">&lt;form&gt;</span>
Background color: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">bgcolor</span> <span class="na">value=</span><span class="s">"</span><span class="cp">&lt;?=</span><span class="nv">$data</span><span class="p">[</span><span class="s1">'bgcolor'</span><span class="p">]</span><span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">submit</span> <span class="na">value=</span><span class="s">"Set color"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>

</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="solution"><span class="me-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Upon inspecting the source code, I saw that Level 11 involved XOR encryption. The method I used to tackle this was to reverse engineer the encryption to find the key used in the encryption, then once the key was obtained, I reencrypted the edited plaintext with the value of show password being yes. A problem that I came across was in using multiple programs to encode the edited plaintext. This was due to invisible characters failing to be displayed, which resulted in error.
<br /></p>
<h3 id="fix"><span class="me-2">Fix</span><a href="#fix" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The solution to this would be to hide the plaintext in a separate secure file which would disable this method. Alternatively, it would be possible to use generate a completely random string and store it in an external file, making it virtually impossible for the attacker to gain another code.</p>

<p><br />
<code class="language-plaintext highlighter-rouge">Password: YWqo0pjpcXzSIl5NMAVxg12QxeC1w9QG</code></p>

<hr />

<h2 id="level-12"><span class="me-2">Level 12</span><a href="#level-12" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h5 id="url-httpnatas12nataslabsoverthewireorg"><span class="me-2">URL: <a href="http://natas12.natas.labs.overthewire.org">http://natas12.natas.labs.overthewire.org</a></span><a href="#url-httpnatas12nataslabsoverthewireorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Credentials: <code class="language-plaintext highlighter-rouge">natas12:YWqo0pjpcXzSIl5NMAVxg12QxeC1w9QG</code></p>

<hr />

<h3 id="code-1"><span class="me-2">Code</span><a href="#code-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="k">function</span> <span class="n">genRandomString</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$length</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="nv">$characters</span> <span class="o">=</span> <span class="s2">"0123456789abcdefghijklmnopqrstuvwxyz"</span><span class="p">;</span>
    <span class="nv">$string</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nv">$p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$p</span> <span class="o">&lt;</span> <span class="nv">$length</span><span class="p">;</span> <span class="nv">$p</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$string</span> <span class="mf">.</span><span class="o">=</span> <span class="nv">$characters</span><span class="p">[</span><span class="nb">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$characters</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)];</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">makeRandomPath</span><span class="p">(</span><span class="nv">$dir</span><span class="p">,</span> <span class="nv">$ext</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">do</span> <span class="p">{</span>
    <span class="nv">$path</span> <span class="o">=</span> <span class="nv">$dir</span><span class="mf">.</span><span class="s2">"/"</span><span class="mf">.</span><span class="nf">genRandomString</span><span class="p">()</span><span class="mf">.</span><span class="s2">"."</span><span class="mf">.</span><span class="nv">$ext</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">while</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$path</span><span class="p">));</span>
    <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">makeRandomPathFromFilename</span><span class="p">(</span><span class="nv">$dir</span><span class="p">,</span> <span class="nv">$fn</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$fn</span><span class="p">,</span> <span class="no">PATHINFO_EXTENSION</span><span class="p">);</span>
    <span class="k">return</span> <span class="nf">makeRandomPath</span><span class="p">(</span><span class="nv">$dir</span><span class="p">,</span> <span class="nv">$ext</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"filename"</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$target_path</span> <span class="o">=</span> <span class="nf">makeRandomPathFromFilename</span><span class="p">(</span><span class="s2">"upload"</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">"filename"</span><span class="p">]);</span>


        <span class="k">if</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'uploadedfile'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"File is too big"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'uploadedfile'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">],</span> <span class="nv">$target_path</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"The file &lt;a href=</span><span class="se">\"</span><span class="nv">$target_path</span><span class="se">\"</span><span class="s2">&gt;</span><span class="nv">$target_path</span><span class="s2">&lt;/a&gt; has been uploaded"</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span><span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"There was an error uploading the file, please try again!"</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="cp">?&gt;</span>

<span class="nt">&lt;form</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"MAX_FILE_SIZE"</span> <span class="na">value=</span><span class="s">"1000"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"filename"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="k">print</span> <span class="nf">genRandomString</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="s">.jpg"</span> <span class="nt">/&gt;</span>
Choose a JPEG to upload (max 1KB):<span class="nt">&lt;br/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"uploadedfile"</span> <span class="na">type=</span><span class="s">"file"</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Upload File"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="cp">&lt;?php</span> <span class="p">}</span> <span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="solution-1"><span class="me-2">Solution</span><a href="#solution-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Level 12 was composed of a file uploader which asked for images to be uploaded, then it would store the file in its directory. To pass this level, I intercepted the request transmitted using Burp Suite, then I changed the contents of the jpeg to a webshell which would allow me to execute commands. I also changed the file type to php, so that it would be compatible with the webshell. Upon forwarding, I changed the URL to from /index.php to /index.php?cmd=cat/etc/natas_webpass/natas13. This line concatenated the contents of the file, which was the password.
<br /></p>
<h3 id="fix-1"><span class="me-2">Fix</span><a href="#fix-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The fix for vulnerabilities with uploading files would be to check the file type against whitelisted file extensions, and have a proper validation system. It would also help to ensure that all contents were converted to plaintext.</p>

<p><br />
<code class="language-plaintext highlighter-rouge">Password: lW3jYRI02ZKDBb8VtQBU1f6eDRo6WEj9</code></p>

<hr />

<h2 id="level-13"><span class="me-2">Level 13</span><a href="#level-13" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h5 id="url-httpnatas13nataslabsoverthewireorg"><span class="me-2">URL: <a href="http://natas13.natas.labs.overthewire.org">http://natas13.natas.labs.overthewire.org</a></span><a href="#url-httpnatas13nataslabsoverthewireorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Credentials: <code class="language-plaintext highlighter-rouge">natas13:lW3jYRI02ZKDBb8VtQBU1f6eDRo6WEj9</code></p>

<hr />

<h3 id="code-2"><span class="me-2">Code</span><a href="#code-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="k">function</span> <span class="n">genRandomString</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$length</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="nv">$characters</span> <span class="o">=</span> <span class="s2">"0123456789abcdefghijklmnopqrstuvwxyz"</span><span class="p">;</span>
    <span class="nv">$string</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nv">$p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$p</span> <span class="o">&lt;</span> <span class="nv">$length</span><span class="p">;</span> <span class="nv">$p</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$string</span> <span class="mf">.</span><span class="o">=</span> <span class="nv">$characters</span><span class="p">[</span><span class="nb">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$characters</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)];</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">makeRandomPath</span><span class="p">(</span><span class="nv">$dir</span><span class="p">,</span> <span class="nv">$ext</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">do</span> <span class="p">{</span>
    <span class="nv">$path</span> <span class="o">=</span> <span class="nv">$dir</span><span class="mf">.</span><span class="s2">"/"</span><span class="mf">.</span><span class="nf">genRandomString</span><span class="p">()</span><span class="mf">.</span><span class="s2">"."</span><span class="mf">.</span><span class="nv">$ext</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">while</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$path</span><span class="p">));</span>
    <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">makeRandomPathFromFilename</span><span class="p">(</span><span class="nv">$dir</span><span class="p">,</span> <span class="nv">$fn</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$fn</span><span class="p">,</span> <span class="no">PATHINFO_EXTENSION</span><span class="p">);</span>
    <span class="k">return</span> <span class="nf">makeRandomPath</span><span class="p">(</span><span class="nv">$dir</span><span class="p">,</span> <span class="nv">$ext</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"filename"</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$target_path</span> <span class="o">=</span> <span class="nf">makeRandomPathFromFilename</span><span class="p">(</span><span class="s2">"upload"</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">"filename"</span><span class="p">]);</span>

    <span class="nv">$err</span><span class="o">=</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'uploadedfile'</span><span class="p">][</span><span class="s1">'error'</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$err</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$err</span> <span class="o">===</span> <span class="mi">2</span><span class="p">){</span>
            <span class="k">echo</span> <span class="s2">"The uploaded file exceeds MAX_FILE_SIZE"</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span><span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"Something went wrong :/"</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'uploadedfile'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"File is too big"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nb">exif_imagetype</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'uploadedfile'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"File is not an image"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'uploadedfile'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">],</span> <span class="nv">$target_path</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"The file &lt;a href=</span><span class="se">\"</span><span class="nv">$target_path</span><span class="se">\"</span><span class="s2">&gt;</span><span class="nv">$target_path</span><span class="s2">&lt;/a&gt; has been uploaded"</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span><span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"There was an error uploading the file, please try again!"</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="cp">?&gt;</span>

<span class="nt">&lt;form</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"MAX_FILE_SIZE"</span> <span class="na">value=</span><span class="s">"1000"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"filename"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="k">print</span> <span class="nf">genRandomString</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="s">.jpg"</span> <span class="nt">/&gt;</span>
Choose a JPEG to upload (max 1KB):<span class="nt">&lt;br/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"uploadedfile"</span> <span class="na">type=</span><span class="s">"file"</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Upload File"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="cp">&lt;?php</span> <span class="p">}</span> <span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="solution-2"><span class="me-2">Solution</span><a href="#solution-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>This stage was almost identical to the previous stage, except it utilized ‘exif_imagetype’ to ensure the file uploaded was an image. Initially, I attempted to bypass it by using terminal to hide a php file within a jpeg, however it was too large as the program now only accepted files smaller than 1KB. Following this, I instead inserted the line GIF89a in the initial area of the code. What this did was that it tricked the program into thinking it was a gif file, which is a subcategory of images, which passed the exif_imagetype check. From here, I created the webshell as before using (replace %3F with ?), and edited the url as before which gave me the password.
<br /></p>
<h3 id="fix-2"><span class="me-2">Fix</span><a href="#fix-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The fix for this vulnerability is the same as the previous issue - check the type of file against whitelisted file extensions, and have a proper validation system, also possibly converting file contents to plaintext.</p>

<p><br />
<code class="language-plaintext highlighter-rouge">Password: qPazSJBmrmU7UQJv17MHk1PGC4DxZMEP</code></p>

<hr />

<h2 id="level-14"><span class="me-2">Level 14</span><a href="#level-14" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h5 id="url-httpnatas14nataslabsoverthewireorg"><span class="me-2">URL: <a href="http://natas14.natas.labs.overthewire.org">http://natas14.natas.labs.overthewire.org</a></span><a href="#url-httpnatas14nataslabsoverthewireorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Credentials: <code class="language-plaintext highlighter-rouge">natas14:qPazSJBmrmU7UQJv17MHk1PGC4DxZMEP</code></p>

<hr />

<h3 id="code-3"><span class="me-2">Code</span><a href="#code-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/level.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/jquery-ui.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/wechall.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/jquery-1.9.1.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/jquery-ui.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">http://natas.labs.overthewire.org/js/wechall-data.js</span><span class="nt">&gt;&lt;/script&gt;&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/wechall.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="kd">var</span> <span class="nx">wechallinfo</span> <span class="o">=</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">level</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">natas14</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">pass</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;censored&gt;</span><span class="dl">"</span> <span class="p">};</span><span class="nt">&lt;/script&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>natas14<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
<span class="cp">&lt;?php</span>
<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"username"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$link</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="s1">'natas14'</span><span class="p">,</span> <span class="s1">'&lt;censored&gt;'</span><span class="p">);</span>
    <span class="nf">mysqli_select_db</span><span class="p">(</span><span class="nv">$link</span><span class="p">,</span> <span class="s1">'natas14'</span><span class="p">);</span>

    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">"SELECT * from users where username=</span><span class="se">\"</span><span class="s2">"</span><span class="mf">.</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]</span><span class="mf">.</span><span class="s2">"</span><span class="se">\"</span><span class="s2"> and password=</span><span class="se">\"</span><span class="s2">"</span><span class="mf">.</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"password"</span><span class="p">]</span><span class="mf">.</span><span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"debug"</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Executing query: </span><span class="nv">$query</span><span class="s2">&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="nf">mysqli_num_rows</span><span class="p">(</span><span class="nf">mysqli_query</span><span class="p">(</span><span class="nv">$link</span><span class="p">,</span> <span class="nv">$query</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"Successful login! The password for natas15 is &lt;censored&gt;&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"Access denied!&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nf">mysqli_close</span><span class="p">(</span><span class="nv">$link</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="cp">?&gt;</span>

<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
Username: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"username"</span><span class="nt">&gt;&lt;br&gt;</span>
Password: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"password"</span><span class="nt">&gt;&lt;br&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Login"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="cp">&lt;?php</span> <span class="p">}</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"viewsource"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"index-source.html"</span><span class="nt">&gt;</span>View sourcecode<span class="nt">&lt;/a&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="solution-3"><span class="me-2">Solution</span><a href="#solution-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Level 14 looks relatively simple - a $_POST request indicating the entry of a username and password into the form. Since guessing the password and username would be almost impossible and brute forcing was not an option, I therefore used an SQL injection as I found that there was usage of mysql in the source code. I wrote ‘’ or “”=“ in place of the password, which meant that the statement provided guaranteed a return true, manipulating the code into thinking that the correct username and password was entered, thus it showed the password.
<br /></p>
<h3 id="fix-3"><span class="me-2">Fix</span><a href="#fix-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The solution to prevent sequel injections would be to stop writing dynamic queries with string concatenation and/or prevent user supplied input containing malicious SQL from affecting the logic of the query.</p>

<p><br />
<code class="language-plaintext highlighter-rouge">Password: TTkaI7AWG4iDERztBcEyKV7kRXH1EZRB</code></p>

<hr />

<h2 id="level-15"><span class="me-2">Level 15</span><a href="#level-15" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h5 id="url-httpnatas15nataslabsoverthewireorg"><span class="me-2">URL: <a href="http://natas15.natas.labs.overthewire.org">http://natas15.natas.labs.overthewire.org</a></span><a href="#url-httpnatas15nataslabsoverthewireorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Credentials: <code class="language-plaintext highlighter-rouge">natas15:TTkaI7AWG4iDERztBcEyKV7kRXH1EZRB</code></p>

<hr />

<h3 id="code-4"><span class="me-2">Code</span><a href="#code-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="c">&lt;!-- This stuff in the header has nothing to do with the level --&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/level.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/jquery-ui.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/wechall.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/jquery-1.9.1.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/jquery-ui.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">http://natas.labs.overthewire.org/js/wechall-data.js</span><span class="nt">&gt;&lt;/script&gt;&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/wechall.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="kd">var</span> <span class="nx">wechallinfo</span> <span class="o">=</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">level</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">natas15</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">pass</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;censored&gt;</span><span class="dl">"</span> <span class="p">};</span><span class="nt">&lt;/script&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>natas15<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
<span class="cp">&lt;?php</span>

<span class="cm">/*
CREATE TABLE `users` (
  `username` varchar(64) DEFAULT NULL,
  `password` varchar(64) DEFAULT NULL
);
*/</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"username"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$link</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="s1">'natas15'</span><span class="p">,</span> <span class="s1">'&lt;censored&gt;'</span><span class="p">);</span>
    <span class="nf">mysqli_select_db</span><span class="p">(</span><span class="nv">$link</span><span class="p">,</span> <span class="s1">'natas15'</span><span class="p">);</span>

    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">"SELECT * from users where username=</span><span class="se">\"</span><span class="s2">"</span><span class="mf">.</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]</span><span class="mf">.</span><span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"debug"</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Executing query: </span><span class="nv">$query</span><span class="s2">&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$res</span> <span class="o">=</span> <span class="nf">mysqli_query</span><span class="p">(</span><span class="nv">$link</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nf">mysqli_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"This user exists.&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"This user doesn't exist.&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Error in query.&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nf">mysqli_close</span><span class="p">(</span><span class="nv">$link</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="cp">?&gt;</span>

<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
Username: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"username"</span><span class="nt">&gt;&lt;br&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Check existence"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="cp">&lt;?php</span> <span class="p">}</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"viewsource"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"index-source.html"</span><span class="nt">&gt;</span>View sourcecode<span class="nt">&lt;/a&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="solution-4"><span class="me-2">Solution</span><a href="#solution-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>This level only had a username box, and it only verified if the user existed. Upon inspecting the code, it could be noted that there was a vulnerability to Blind SQL injection, where I would have to add another condition such as ‘1=1’ to create a true false statement regarding the password. http://natas15.natas.labs.overthewire.org/index.php?username=natas16%22%20and%20ord(mid(password,1,1))%3E97%20and%20%221%22=%221 This line shows how it would be done to check the 1st char of the password. The data tables were shown in the source code, and the username was already known.
<br /></p>
<h3 id="fix-4"><span class="me-2">Fix</span><a href="#fix-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The fix for a vulnerability to blind sql injection would be to use parametrized queries that would ensure that the user would be unable to interfere with the SQL query.</p>

<p><br />
<code class="language-plaintext highlighter-rouge">Password: TRD7iZrd5gATjj9PkPEuaOlfEjHqj32V</code></p>

<hr />

<h2 id="level-16"><span class="me-2">Level 16</span><a href="#level-16" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h5 id="url-httpnatas16nataslabsoverthewireorg"><span class="me-2">URL: <a href="http://natas16.natas.labs.overthewire.org">http://natas16.natas.labs.overthewire.org</a></span><a href="#url-httpnatas16nataslabsoverthewireorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Credentials: <code class="language-plaintext highlighter-rouge">natas16:TRD7iZrd5gATjj9PkPEuaOlfEjHqj32V</code></p>

<hr />

<h3 id="code-5"><span class="me-2">Code</span><a href="#code-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="c">&lt;!-- This stuff in the header has nothing to do with the level --&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/level.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/jquery-ui.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/wechall.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/jquery-1.9.1.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/jquery-ui.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">http://natas.labs.overthewire.org/js/wechall-data.js</span><span class="nt">&gt;&lt;/script&gt;&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/wechall.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="kd">var</span> <span class="nx">wechallinfo</span> <span class="o">=</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">level</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">natas16</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">pass</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;censored&gt;</span><span class="dl">"</span> <span class="p">};</span><span class="nt">&lt;/script&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>natas16<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>

For security reasons, we now filter even more on certain characters<span class="nt">&lt;br/&gt;&lt;br/&gt;</span>
<span class="nt">&lt;form&gt;</span>
Find words containing: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">needle</span><span class="nt">&gt;&lt;input</span> <span class="na">type=</span><span class="s">submit</span> <span class="na">name=</span><span class="s">submit</span> <span class="na">value=</span><span class="s">Search</span><span class="nt">&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="nt">&lt;/form&gt;</span>


Output:
<span class="nt">&lt;pre&gt;</span>
<span class="cp">&lt;?</span>
<span class="nv">$key</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"needle"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$key</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"needle"</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$key</span> <span class="o">!=</span> <span class="s2">""</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/[;|&amp;`\'"]/'</span><span class="p">,</span><span class="nv">$key</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">print</span> <span class="s2">"Input contains an illegal character!"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">passthru</span><span class="p">(</span><span class="s2">"grep -i </span><span class="se">\"</span><span class="nv">$key</span><span class="se">\"</span><span class="s2"> dictionary.txt"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
<span class="nt">&lt;/pre&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"viewsource"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"index-source.html"</span><span class="nt">&gt;</span>View sourcecode<span class="nt">&lt;/a&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="solution-5"><span class="me-2">Solution</span><a href="#solution-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>This level bore resemblance to level 10, however the difference was that it had filtered out the double quotes as well as everything else. This was a problem because it forced a different solution. To get to the password, I utilized the grep function in the url of the page. by inserting KEYWORD$(grep char /etc/natas_webpass/natas17), I was able to determine which characters were in the password by running a line of code which returned the character and concatenated it to a string when the keyword didn’t appear. To find out what order they were in, I used the ^ in front of the char string. By doing this with the list of filtered out characters, I was able to determine what character started the password and which ones succeeded it.
<br /></p>
<h3 id="fix-5"><span class="me-2">Fix</span><a href="#fix-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The fix for this vulnerability would be to incorporate a whitelist that only allows the input and returns characters, which disables the usage of characters such as () or / which are essential in this attack.</p>

<p><br />
<code class="language-plaintext highlighter-rouge">Password: XkEuChE0SbnKBvH1RU7ksIb9uuLmI7sd</code></p>

<hr />

<h2 id="level-17"><span class="me-2">Level 17</span><a href="#level-17" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h5 id="url-httpnatas-17nataslabsoverthewireorg"><span class="me-2">URL: <a href="http://natas17.natas.labs.overthewire.org">http://natas 17.natas.labs.overthewire.org</a></span><a href="#url-httpnatas-17nataslabsoverthewireorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Credentials: <code class="language-plaintext highlighter-rouge">natas17:XkEuChE0SbnKBvH1RU7ksIb9uuLmI7sd</code></p>

<hr />

<h3 id="code-6"><span class="me-2">Code</span><a href="#code-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>natas17<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
<span class="cp">&lt;?php</span>

<span class="cm">/*
CREATE TABLE `users` (
  `username` varchar(64) DEFAULT NULL,
  `password` varchar(64) DEFAULT NULL
);
*/</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"username"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$link</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="s1">'natas17'</span><span class="p">,</span> <span class="s1">'&lt;censored&gt;'</span><span class="p">);</span>
    <span class="nf">mysqli_select_db</span><span class="p">(</span><span class="nv">$link</span><span class="p">,</span> <span class="s1">'natas17'</span><span class="p">);</span>

    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">"SELECT * from users where username=</span><span class="se">\"</span><span class="s2">"</span><span class="mf">.</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]</span><span class="mf">.</span><span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"debug"</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Executing query: </span><span class="nv">$query</span><span class="s2">&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$res</span> <span class="o">=</span> <span class="nf">mysqli_query</span><span class="p">(</span><span class="nv">$link</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nf">mysqli_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//echo "This user exists.&lt;br&gt;";</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">//echo "This user doesn't exist.&lt;br&gt;";</span>
    <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">//echo "Error in query.&lt;br&gt;";</span>
    <span class="p">}</span>

    <span class="nf">mysqli_close</span><span class="p">(</span><span class="nv">$link</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="cp">?&gt;</span>

<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
Username: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"username"</span><span class="nt">&gt;&lt;br&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Check existence"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="cp">&lt;?php</span> <span class="p">}</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"viewsource"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"index-source.html"</span><span class="nt">&gt;</span>View sourcecode<span class="nt">&lt;/a&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="solution-6"><span class="me-2">Solution</span><a href="#solution-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>In this level, it was clear that the level had SQL vulnerabilities because of the page’s usage of mysql. Looking at the code, there was nothing that would support boolean based blind sql injection, so I resorted to a time based sql injection method by using SQLmap. Then method worked by inserting the time delay condition which would be activated and noticed if the other condition was fulfilled, which was if the characters were in the password. It required me to provide authentication and table information to the sqlmap, and it did the rest of the work, giving me the password. SQLMap simply performs sql injections automatically at mechanical precision, which make it a lot more time saving especially for time based SQL injections.
<br /></p>
<h3 id="fix-6"><span class="me-2">Fix</span><a href="#fix-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The solution to prevent sequel injections would be to stop writing dynamic queries with string concatenation and/or prevent user supplied input containing malicious SQL from affecting the logic of the query.</p>

<p><br />
<code class="language-plaintext highlighter-rouge">Password: 8NEDUUxg8kFgPV84uLwvZkGn6okJQ6aq</code></p>

<hr />

<h2 id="level-18"><span class="me-2">Level 18</span><a href="#level-18" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h5 id="url-httpnatas18nataslabsoverthewireorg"><span class="me-2">URL: <a href="http://natas18.natas.labs.overthewire.org">http://natas18.natas.labs.overthewire.org</a></span><a href="#url-httpnatas18nataslabsoverthewireorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Credentials: <code class="language-plaintext highlighter-rouge">natas18:8NEDUUxg8kFgPV84uLwvZkGn6okJQ6aq</code></p>

<hr />

<h3 id="code-7"><span class="me-2">Code</span><a href="#code-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>natas18<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
<span class="cp">&lt;?php</span>

<span class="nv">$maxid</span> <span class="o">=</span> <span class="mi">640</span><span class="p">;</span> <span class="c1">// 640 should be enough for everyone</span>

<span class="k">function</span> <span class="n">isValidAdminLogin</span><span class="p">()</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"admin"</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* This method of authentication appears to be unsafe and has been disabled for now. */</span>
        <span class="c1">//return 1;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">isValidID</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">return</span> <span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">createID</span><span class="p">(</span><span class="nv">$user</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">global</span> <span class="nv">$maxid</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nv">$maxid</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">debug</span><span class="p">(</span><span class="nv">$msg</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"debug"</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">print</span> <span class="s2">"DEBUG: </span><span class="nv">$msg</span><span class="s2">&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">my_session_start</span><span class="p">()</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"PHPSESSID"</span><span class="p">,</span> <span class="nv">$_COOKIE</span><span class="p">)</span> <span class="k">and</span> <span class="nf">isValidID</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">"PHPSESSID"</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">session_start</span><span class="p">())</span> <span class="p">{</span>
        <span class="nf">debug</span><span class="p">(</span><span class="s2">"Session start failed"</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">debug</span><span class="p">(</span><span class="s2">"Session start ok"</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"admin"</span><span class="p">,</span> <span class="nv">$_SESSION</span><span class="p">))</span> <span class="p">{</span>
        <span class="nf">debug</span><span class="p">(</span><span class="s2">"Session was old: admin flag set"</span><span class="p">);</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// backwards compatible, secure</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">print_credentials</span><span class="p">()</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span> <span class="k">and</span> <span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"admin"</span><span class="p">,</span> <span class="nv">$_SESSION</span><span class="p">)</span> <span class="k">and</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"You are an admin. The credentials for the next level are:&lt;br&gt;"</span><span class="p">;</span>
    <span class="k">print</span> <span class="s2">"&lt;pre&gt;Username: natas19</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
    <span class="k">print</span> <span class="s2">"Password: &lt;censored&gt;&lt;/pre&gt;"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"You are logged in as a regular user. Login as an admin to retrieve credentials for natas19."</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="nv">$showform</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="nf">my_session_start</span><span class="p">())</span> <span class="p">{</span>
    <span class="nf">print_credentials</span><span class="p">();</span>
    <span class="nv">$showform</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"username"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"password"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nb">session_id</span><span class="p">(</span><span class="nf">createID</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]));</span>
    <span class="nb">session_start</span><span class="p">();</span>
    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span> <span class="o">=</span> <span class="nf">isValidAdminLogin</span><span class="p">();</span>
    <span class="nf">debug</span><span class="p">(</span><span class="s2">"New session started"</span><span class="p">);</span>
    <span class="nv">$showform</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nf">print_credentials</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$showform</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">?&gt;</span>

<span class="nt">&lt;p&gt;</span>
Please login with your admin account to retrieve credentials for natas19.
<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
Username: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"username"</span><span class="nt">&gt;&lt;br&gt;</span>
Password: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"password"</span><span class="nt">&gt;&lt;br&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Login"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="cp">&lt;?php</span> <span class="p">}</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"viewsource"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"index-source.html"</span><span class="nt">&gt;</span>View sourcecode<span class="nt">&lt;/a&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="solution-7"><span class="me-2">Solution</span><a href="#solution-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>This level required cookie manipulation. It would be known that the user would be admin and the password was unknown, however by using Burp Suite and running through the first 640 possible cookie ids (640 was the maximum id of a cookie), I found one irregularity and replaced my cookie with that id and was given the password.
<br /></p>
<h3 id="fix-7"><span class="me-2">Fix</span><a href="#fix-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The solution for this would be to use a randomly generated encryption method in place of the cookie and store the data in a secure file to ensure that it would be near impossible to recreate the cookie. The cookie should also be signed to prevent client sided cookie manipulation improving the server security and decreasing the risk of a cookie hijacking attack.</p>

<p><br />
<code class="language-plaintext highlighter-rouge">Password: 8LMJEhKFbMKIL2mxQKjv0aEDdk7zpT0s</code></p>

<hr />

<h2 id="level-19"><span class="me-2">Level 19</span><a href="#level-19" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h5 id="url-httpnatas19nataslabsoverthewireorg"><span class="me-2">URL: <a href="http://natas19.natas.labs.overthewire.org">http://natas19.natas.labs.overthewire.org</a></span><a href="#url-httpnatas19nataslabsoverthewireorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<details>
<summary>Click me for the Level Credentials!</summary>
Credentials: `natas19:8LMJEhKFbMKIL2mxQKjv0aEDdk7zpT0s`
</details>

<hr />

<h3 id="code-8"><span class="me-2">Code</span><a href="#code-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="c">&lt;!-- This stuff in the header has nothing to do with the level --&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/level.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/jquery-ui.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/wechall.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/jquery-1.9.1.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/jquery-ui.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">http://natas.labs.overthewire.org/js/wechall-data.js</span><span class="nt">&gt;&lt;/script&gt;&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/wechall.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="kd">var</span> <span class="nx">wechallinfo</span> <span class="o">=</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">level</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">natas19</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">pass</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;censored&gt;</span><span class="dl">"</span> <span class="p">};</span><span class="nt">&lt;/script&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>natas19<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
<span class="nt">&lt;p&gt;</span>
<span class="nt">&lt;b&gt;</span>
This page uses mostly the same code as the previous level, but session IDs are no longer sequential...
<span class="nt">&lt;/b&gt;</span>
<span class="nt">&lt;/p&gt;</span>
<span class="cp">&lt;?php</span>

<span class="nv">$maxid</span> <span class="o">=</span> <span class="mi">640</span><span class="p">;</span> <span class="c1">// 640 should be enough for everyone</span>

<span class="k">function</span> <span class="n">myhex2bin</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">{</span> 
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="nv">$r</span><span class="o">=</span><span class="s1">''</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nv">$a</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$a</span><span class="o">&lt;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span> <span class="nv">$a</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$r</span><span class="mf">.</span><span class="o">=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$h</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span><span class="mf">.</span><span class="nv">$h</span><span class="p">[(</span><span class="nv">$a</span><span class="o">+</span><span class="mi">1</span><span class="p">)]));</span> <span class="p">}</span>
  <span class="k">return</span> <span class="nv">$r</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">isValidAdminLogin</span><span class="p">()</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"admin"</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* This method of authentication appears to be unsafe and has been disabled for now. */</span>
        <span class="c1">//return 1;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">isValidID</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span> 
    <span class="c1">// must be lowercase</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$id</span> <span class="o">!=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$id</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// must decode</span>
    <span class="nv">$decoded</span> <span class="o">=</span> <span class="nf">myhex2bin</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>

    <span class="c1">// must contain a number and a username</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/^(?P&lt;id&gt;\d+)-(?P&lt;name&gt;\w+)$/'</span><span class="p">,</span> <span class="nv">$decoded</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">createID</span><span class="p">(</span><span class="nv">$user</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">global</span> <span class="nv">$maxid</span><span class="p">;</span>
    <span class="nv">$idnum</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nv">$maxid</span><span class="p">);</span>
    <span class="nv">$idstr</span> <span class="o">=</span> <span class="s2">"</span><span class="nv">$idnum</span><span class="s2">-</span><span class="nv">$user</span><span class="s2">"</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">bin2hex</span><span class="p">(</span><span class="nv">$idstr</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">debug</span><span class="p">(</span><span class="nv">$msg</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"debug"</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">print</span> <span class="s2">"DEBUG: </span><span class="nv">$msg</span><span class="s2">&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">my_session_start</span><span class="p">()</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"PHPSESSID"</span><span class="p">,</span> <span class="nv">$_COOKIE</span><span class="p">)</span> <span class="k">and</span> <span class="nf">isValidID</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">"PHPSESSID"</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">session_start</span><span class="p">())</span> <span class="p">{</span>
        <span class="nf">debug</span><span class="p">(</span><span class="s2">"Session start failed"</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">debug</span><span class="p">(</span><span class="s2">"Session start ok"</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"admin"</span><span class="p">,</span> <span class="nv">$_SESSION</span><span class="p">))</span> <span class="p">{</span>
        <span class="nf">debug</span><span class="p">(</span><span class="s2">"Session was old: admin flag set"</span><span class="p">);</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// backwards compatible, secure</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">print_credentials</span><span class="p">()</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span> <span class="k">and</span> <span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"admin"</span><span class="p">,</span> <span class="nv">$_SESSION</span><span class="p">)</span> <span class="k">and</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"You are an admin. The credentials for the next level are:&lt;br&gt;"</span><span class="p">;</span>
    <span class="k">print</span> <span class="s2">"&lt;pre&gt;Username: natas20</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
    <span class="k">print</span> <span class="s2">"Password: &lt;censored&gt;&lt;/pre&gt;"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"You are logged in as a regular user. Login as an admin to retrieve credentials for natas20."</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="nv">$showform</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="nf">my_session_start</span><span class="p">())</span> <span class="p">{</span>
    <span class="nf">print_credentials</span><span class="p">();</span>
    <span class="nv">$showform</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"username"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"password"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nb">session_id</span><span class="p">(</span><span class="nf">createID</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]));</span>
    <span class="nb">session_start</span><span class="p">();</span>
    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span> <span class="o">=</span> <span class="nf">isValidAdminLogin</span><span class="p">();</span>
    <span class="nf">debug</span><span class="p">(</span><span class="s2">"New session started"</span><span class="p">);</span>
    <span class="nv">$showform</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nf">print_credentials</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$showform</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">?&gt;</span>

<span class="nt">&lt;p&gt;</span>
Please login with your admin account to retrieve credentials for natas20.
<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
Username: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"username"</span><span class="nt">&gt;&lt;br&gt;</span>
Password: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"password"</span><span class="nt">&gt;&lt;br&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Login"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="cp">&lt;?php</span> <span class="p">}</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="solution-8"><span class="me-2">Solution</span><a href="#solution-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Level 19 was the same as level 18, however this time the session codes were formatted differently. I could see that it was hex code, and after entering the username, I found that the format was [ID-USERNAME]. Having found this out, I ran a script that converted numbers 1-640 to hex code and appended ‘2d61646d696ea’ to the end of the encoded values and ran a sniper attack cycling through the payloads until I was returned the password.
<br /></p>
<h3 id="fix-8"><span class="me-2">Fix</span><a href="#fix-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The quick solution for this would be to sign each individual cookie to ensure that the attacker cannot change the cookie id and conduct an attack because signing a cookie detects if the cookie has been tampered with.</p>

<p><br />
<code class="language-plaintext highlighter-rouge">Password: guVaZ3ET35LbgbFMoaN5tFcYT1jEP7UH</code></p>

<hr />

<h2 id="level-20"><span class="me-2">Level 20</span><a href="#level-20" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h5 id="url-httpnatas20nataslabsoverthewireorg"><span class="me-2">URL: <a href="http://natas20.natas.labs.overthewire.org">http://natas20.natas.labs.overthewire.org</a></span><a href="#url-httpnatas20nataslabsoverthewireorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Credentials: <code class="language-plaintext highlighter-rouge">natas20:guVaZ3ET35LbgbFMoaN5tFcYT1jEP7UH</code></p>

<hr />

<h3 id="code-9"><span class="me-2">Code</span><a href="#code-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="c">&lt;!-- This stuff in the header has nothing to do with the level --&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/level.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/jquery-ui.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://natas.labs.overthewire.org/css/wechall.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/jquery-1.9.1.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/jquery-ui.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">http://natas.labs.overthewire.org/js/wechall-data.js</span><span class="nt">&gt;&lt;/script&gt;&lt;script </span><span class="na">src=</span><span class="s">"http://natas.labs.overthewire.org/js/wechall.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="kd">var</span> <span class="nx">wechallinfo</span> <span class="o">=</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">level</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">natas20</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">pass</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;censored&gt;</span><span class="dl">"</span> <span class="p">};</span><span class="nt">&lt;/script&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span>natas20<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
<span class="cp">&lt;?php</span>

<span class="k">function</span> <span class="n">debug</span><span class="p">(</span><span class="nv">$msg</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"debug"</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">print</span> <span class="s2">"DEBUG: </span><span class="nv">$msg</span><span class="s2">&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">print_credentials</span><span class="p">()</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span> <span class="k">and</span> <span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"admin"</span><span class="p">,</span> <span class="nv">$_SESSION</span><span class="p">)</span> <span class="k">and</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"admin"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"You are an admin. The credentials for the next level are:&lt;br&gt;"</span><span class="p">;</span>
    <span class="k">print</span> <span class="s2">"&lt;pre&gt;Username: natas21</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
    <span class="k">print</span> <span class="s2">"Password: &lt;censored&gt;&lt;/pre&gt;"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"You are logged in as a regular user. Login as an admin to retrieve credentials for natas21."</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="cm">/* we don't need this */</span>
<span class="k">function</span> <span class="n">myopen</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span> <span class="nv">$name</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//debug("MYOPEN $path $name");</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* we don't need this */</span>
<span class="k">function</span> <span class="n">myclose</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//debug("MYCLOSE");</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">myread</span><span class="p">(</span><span class="nv">$sid</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">debug</span><span class="p">(</span><span class="s2">"MYREAD </span><span class="nv">$sid</span><span class="s2">"</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">strspn</span><span class="p">(</span><span class="nv">$sid</span><span class="p">,</span> <span class="s2">"1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM-"</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$sid</span><span class="p">))</span> <span class="p">{</span>
    <span class="nf">debug</span><span class="p">(</span><span class="s2">"Invalid SID"</span><span class="p">);</span>
        <span class="k">return</span> <span class="s2">""</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$filename</span> <span class="o">=</span> <span class="nb">session_save_path</span><span class="p">()</span> <span class="mf">.</span> <span class="s2">"/"</span> <span class="mf">.</span> <span class="s2">"mysess_"</span> <span class="mf">.</span> <span class="nv">$sid</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$filename</span><span class="p">))</span> <span class="p">{</span>
        <span class="nf">debug</span><span class="p">(</span><span class="s2">"Session file doesn't exist"</span><span class="p">);</span>
        <span class="k">return</span> <span class="s2">""</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nf">debug</span><span class="p">(</span><span class="s2">"Reading from "</span><span class="mf">.</span> <span class="nv">$filename</span><span class="p">);</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span>
    <span class="nv">$_SESSION</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="nv">$data</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">debug</span><span class="p">(</span><span class="s2">"Read [</span><span class="nv">$line</span><span class="s2">]"</span><span class="p">);</span>
    <span class="nv">$parts</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="nv">$line</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">""</span><span class="p">)</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="nv">$parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nv">$parts</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">session_encode</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">mywrite</span><span class="p">(</span><span class="nv">$sid</span><span class="p">,</span> <span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// $data contains the serialized version of $_SESSION</span>
    <span class="c1">// but our encoding is better</span>
    <span class="nf">debug</span><span class="p">(</span><span class="s2">"MYWRITE </span><span class="nv">$sid</span><span class="s2"> </span><span class="nv">$data</span><span class="s2">"</span><span class="p">);</span>
    <span class="c1">// make sure the sid is alnum only!!</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">strspn</span><span class="p">(</span><span class="nv">$sid</span><span class="p">,</span> <span class="s2">"1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM-"</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$sid</span><span class="p">))</span> <span class="p">{</span>
    <span class="nf">debug</span><span class="p">(</span><span class="s2">"Invalid SID"</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$filename</span> <span class="o">=</span> <span class="nb">session_save_path</span><span class="p">()</span> <span class="mf">.</span> <span class="s2">"/"</span> <span class="mf">.</span> <span class="s2">"mysess_"</span> <span class="mf">.</span> <span class="nv">$sid</span><span class="p">;</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="nf">debug</span><span class="p">(</span><span class="s2">"Saving in "</span><span class="mf">.</span> <span class="nv">$filename</span><span class="p">);</span>
    <span class="nb">ksort</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">);</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">debug</span><span class="p">(</span><span class="s2">"</span><span class="nv">$key</span><span class="s2"> =&gt; </span><span class="nv">$value</span><span class="s2">"</span><span class="p">);</span>
        <span class="nv">$data</span> <span class="mf">.</span><span class="o">=</span> <span class="s2">"</span><span class="nv">$key</span><span class="s2"> </span><span class="nv">$value</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nv">$data</span><span class="p">);</span>
    <span class="nb">chmod</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="mo">0600</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* we don't need this */</span>
<span class="k">function</span> <span class="n">mydestroy</span><span class="p">(</span><span class="nv">$sid</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//debug("MYDESTROY $sid");</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/* we don't need this */</span>
<span class="k">function</span> <span class="n">mygarbage</span><span class="p">(</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//debug("MYGARBAGE $t");</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">session_set_save_handler</span><span class="p">(</span>
    <span class="s2">"myopen"</span><span class="p">,</span>
    <span class="s2">"myclose"</span><span class="p">,</span>
    <span class="s2">"myread"</span><span class="p">,</span>
    <span class="s2">"mywrite"</span><span class="p">,</span>
    <span class="s2">"mydestroy"</span><span class="p">,</span>
    <span class="s2">"mygarbage"</span><span class="p">);</span>
<span class="nb">session_start</span><span class="p">();</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"name"</span><span class="p">];</span>
    <span class="nf">debug</span><span class="p">(</span><span class="s2">"Name set to "</span> <span class="mf">.</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]);</span>
<span class="p">}</span>

<span class="nf">print_credentials</span><span class="p">();</span>

<span class="nv">$name</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="nv">$_SESSION</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"name"</span><span class="p">];</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>

<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
Your name: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">&lt;?=</span><span class="nv">$name</span><span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;&lt;br&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Change name"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"viewsource"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"index-source.html"</span><span class="nt">&gt;</span>View sourcecode<span class="nt">&lt;/a&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="solution-9"><span class="me-2">Solution</span><a href="#solution-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Level 20 contained of a password box asking for a name. Looking at the source code, I could see that the conditions needed for the password to be revealed was that the session had to contain the string ‘admin’ and the value admin had to be set as 1. To do this, I ran a python script that, after authenticating its connection to the server, it would submit ‘name=admin\nadmin 1’. What this did was that it set the name to admin and the ‘\n’ caused a line break, saving the string ‘admin 1’ on the following line. The reason that it was written as ‘admin 1’ and not admin=1 is because of how the file would store the session data.
<br /></p>
<h3 id="fix-9"><span class="me-2">Fix</span><a href="#fix-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The solution for this would be to only save the first line of input and use readline(1) to only account for the first line and ignore the rest of the response provided by the user.</p>

<p><br />
<code class="language-plaintext highlighter-rouge">Password: 89OWrTkGmiLZLv12JY4tLj2c4FW0xn56</code></p>

<h2 id="whats-next"><span class="me-2">What’s Next?</span><a href="#whats-next" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>If you are interested in reading about the next 5 levels, click <a href="/practice1.github.io/posts/nataslevel21-25/"><strong>here</strong></a>.
<br /></p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw me-1"></i>
    
      <a href='/practice1.github.io/categories/blogging/'>Blogging</a>,
      <a href='/practice1.github.io/categories/writeup/'>Writeup</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw me-1"></i>
      
      <a href="/practice1.github.io/tags/blogging/"
          class="post-tag no-text-decoration" >Blogging</a>
      
      <a href="/practice1.github.io/tags/cybersecurity/"
          class="post-tag no-text-decoration" >Cybersecurity</a>
      
      <a href="/practice1.github.io/tags/programming/"
          class="post-tag no-text-decoration" >Programming</a>
      
      <a href="/practice1.github.io/tags/wargame/"
          class="post-tag no-text-decoration" >Wargame</a>
      
      <a href="/practice1.github.io/tags/natas/"
          class="post-tag no-text-decoration" >Natas</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!-- Post sharing snippet -->

<div class="share-wrapper">
  <span class="share-label text-muted me-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
      <a
        href="https://twitter.com/intent/tweet?text=Natas%20Wargame%20Writeup%20(Levels%2011-20)%20-%20ukom2%20Blog&url=http%3A%2F%2Flocalhost%3A4000%2Fpractice1.github.io%2Fposts%2Fnataslevel11-20%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Twitter"
        target="_blank"
        rel="noopener"
        aria-label="Twitter"
      >
        <i class="fa-fw fab fa-twitter"></i>
      </a>
    
      
      <a
        href="https://www.facebook.com/sharer/sharer.php?title=Natas%20Wargame%20Writeup%20(Levels%2011-20)%20-%20ukom2%20Blog&u=http%3A%2F%2Flocalhost%3A4000%2Fpractice1.github.io%2Fposts%2Fnataslevel11-20%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Facebook"
        target="_blank"
        rel="noopener"
        aria-label="Facebook"
      >
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    
      
      <a
        href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fpractice1.github.io%2Fposts%2Fnataslevel11-20%2F&text=Natas%20Wargame%20Writeup%20(Levels%2011-20)%20-%20ukom2%20Blog"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Telegram"
        target="_blank"
        rel="noopener"
        aria-label="Telegram"
      >
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none"></i>
    </button>
  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
      
    </div>
  </div>
  <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
    <div class="access">
      <!-- Get the last 5 posts from lastmod list. -->














  <div id="access-lastmod" class="post">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/practice1.github.io/posts/nataslevel0to10/">Natas Wargame Writeup (Levels 0-10)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/practice1.github.io/posts/OWASPResearch1/">OWASP Research Page</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/practice1.github.io/posts/nataslevel21-25/">Natas Wargame Writeup (Levels 21-25)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/practice1.github.io/posts/getting-started/">Introduction to Natas Wargame</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/practice1.github.io/posts/nataslevel11-20/">Natas Wargame Writeup (Levels 11-20)</a>
        </li>
      
    </ul>
  </div>
  <!-- #access-lastmod -->


      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/blogging/">Blogging</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/cybersecurity/">Cybersecurity</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/natas/">Natas</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/programming/">Programming</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/wargame/">Wargame</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/internship-summary/">Internship summary</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/introduction/">Introduction</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/owasp/">OWASP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/research/">Research</a>
      
    </div>
  </div>


    </div>

    
      
      



  <div id="toc-wrapper" class="ps-0 pe-4 mb-5">
    <div class="panel-heading ps-3 pt-2 mb-2">Contents</div>
    <nav id="toc"></nav>
  </div>


    
  </div>
</div>

<!-- tail -->

  <div class="row">
    <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5">
      
        
        <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ms-1" data-toc-skip>
      Further Reading
    </h3>
    <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <div class="col">
          <a href="/practice1.github.io/posts/nataslevel21-25/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1691412900"
  data-df="ll"
  
>
  Aug  7, 2023
</em>

              <h4 class="pt-0 my-2" data-toc-skip>Natas Wargame Writeup (Levels 21-25)</h4>
              <div class="text-muted small">
                <p>
                  





                  Introduction

This blog post contains the writeup for the natas wargame levels 21 to 25.
If you haven’t already, I recommend reading the previous articles on the introduction and the writeups on Le...
                </p>
              </div>
            </div>
          </a>
        </div>
      
        <div class="col">
          <a href="/practice1.github.io/posts/nataslevel0to10/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1691413020"
  data-df="ll"
  
>
  Aug  7, 2023
</em>

              <h4 class="pt-0 my-2" data-toc-skip>Natas Wargame Writeup (Levels 0-10)</h4>
              <div class="text-muted small">
                <p>
                  





                  Introduction

This writeup demonstrates each level of the natas wargame and all solutions needed to solve each level alongside the password and possible real world fixes to prevent the exploiting o...
                </p>
              </div>
            </div>
          </a>
        </div>
      
        <div class="col">
          <a href="/practice1.github.io/posts/OWASPResearch1/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1691931300"
  data-df="ll"
  
>
  Aug 13, 2023
</em>

              <h4 class="pt-0 my-2" data-toc-skip>OWASP Research Page</h4>
              <div class="text-muted small">
                <p>
                  





                  

                </p>
              </div>
            </div>
          </a>
        </div>
      
    </div>
    <!-- .card-deck -->
  </div>
  <!-- #related-posts -->


      
        
        <!-- Navigation buttons at the bottom of the post. -->

<div class="post-navigation d-flex justify-content-between">
  
    <a
      href="/practice1.github.io/posts/getting-started/"
      class="btn btn-outline-primary"
      prompt="Older"
    >
      <p>Introduction to Natas Wargame</p>
    </a>
  

  
    <a
      href="/practice1.github.io/posts/nataslevel0to10/"
      class="btn btn-outline-primary"
      prompt="Newer"
    >
      <p>Natas Wargame Writeup (Levels 0-10)</p>
    </a>
  
</div>

      
        
        <!--  The comments switcher -->

  
  <!-- The Disqus lazy loading. -->
<div id="disqus_thread" class="pt-2 pb-2">
  <p class="text-center text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p>
</div>

<script type="text/javascript">
  var disqus_config = function () {
    this.page.url = 'http://localhost:4000/practice1.github.io/posts/nataslevel11-20/';
    this.page.identifier = '/posts/nataslevel11-20/';
  };

  /* Lazy loading */
  var disqus_observer = new IntersectionObserver(
    function (entries) {
      if (entries[0].isIntersecting) {
        (function () {
          var d = document,
            s = d.createElement('script');
          s.src = 'https://https-ukom2-github-io-practice1-github-io.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();

        disqus_observer.disconnect();
      }
    },
    { threshold: [0] }
  );

  disqus_observer.observe(document.querySelector('#disqus_thread'));

  /* Auto switch theme */
  function reloadDisqus() {
    if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {
      /* Disqus hasn't been loaded */
      if (typeof DISQUS === 'undefined') {
        return;
      }

      if (document.readyState == 'complete') {
        DISQUS.reset({ reload: true, config: disqus_config });
      }
    }
  }

  if (document.querySelector('.mode-toggle')) {
    window.addEventListener('message', reloadDisqus);
  }
</script>

  <div id="disqus_thread"></div>
  <script>
      var disqus_config = function () {
      this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };

      (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://https-ukom2-github-io-practice1-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


      
    </div>
  </div>


        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 post-content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/blogging/">Blogging</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/cybersecurity/">Cybersecurity</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/natas/">Natas</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/programming/">Programming</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/wargame/">Wargame</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/internship-summary/">Internship summary</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/introduction/">Introduction</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/owasp/">OWASP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/practice1.github.io/tags/research/">Research</a>
      
    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>
    </div>

    <!-- The Footer -->

<footer>
  <div class="container px-lg-4">
    <div class="d-flex justify-content-center align-items-center text-muted mx-md-3">
      <p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
      </p>

      <p>©
        2023
        <a href="https://github.com/ukom2">ukom2</a>.
        
          <span
            data-bs-toggle="tooltip"
            data-bs-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
          >Some rights reserved.</span>
        
      </p>
    </div>
  </div>
</footer>


    <div id="mask"></div>

    <button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow">
      <i class="fas fa-angle-up"></i>
    </button>

    
      <div
        id="notification"
        class="toast"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
        data-bs-animation="true"
        data-bs-autohide="false"
      >
        <div class="toast-header">
          <button
            type="button"
            class="btn-close ms-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="px-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js,npm/mermaid@9.4.3/dist/mermaid.min.js"></script>






<script defer src="/practice1.github.io/assets/js/dist/post.min.js"></script>






    
      <!-- mermaid-js loader -->
<script type="text/javascript">
  (function () {
    function updateMermaid(event) {
      if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {
        const mode = event.data.message;

        if (typeof mermaid === 'undefined') {
          return;
        }

        let expectedTheme = mode === ModeToggle.DARK_MODE ? 'dark' : 'default';
        let config = { theme: expectedTheme };

        /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $('.mermaid').each(function () {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr('data-processed');
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, '.mermaid');
      }
    }

    let initTheme = 'default';
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = 'dark';
    }

    let mermaidConf = {
      theme: initTheme /* <default|dark|forest|neutral> */
    };

    /* Create mermaid tag */
    document.querySelectorAll('pre>code.language-mermaid').forEach((elem) => {
      const svgCode = elem.textContent;
      const backup = elem.parentElement;
      backup.classList.add('unloaded');
      /* create mermaid node */
      let mermaid = document.createElement('pre');
      mermaid.classList.add('mermaid');
      const text = document.createTextNode(svgCode);
      mermaid.appendChild(text);
      backup.after(mermaid);
    });

    mermaid.initialize(mermaidConf);

    window.addEventListener('message', updateMermaid);
  })();
</script>

    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/practice1.github.io/assets/js/data/search.json',
    searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

